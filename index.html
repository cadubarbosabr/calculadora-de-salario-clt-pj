<!DOCTYPE html>
<html lang="pt-BR" class="dark">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Calculadora CLT x PJ 2026</title>

    <script src="https://cdn.tailwindcss.com"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#f97316', // Laranja 500
                        primaryHover: '#ea580c', // Laranja 600
                        darkBg: '#0f172a', // Slate 900
                        cardBg: '#1e293b', // Slate 800
                    }
                }
            }
        }
    </script>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0f172a;
            color: #f1f5f9;
        }

        /* Remove setas dos inputs numéricos */
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        input[type=number] {
            -moz-appearance: textfield;
        }

        /* Animação suave */
        .fade-in {
            animation: fadeIn 0.4s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>

<body class="bg-slate-950 text-slate-100 antialiased selection:bg-orange-500 selection:text-white">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- ÍCONES (SVG Puro para evitar erros de importação) ---
        const Icons = {
            Calculator: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="16" height="20" x="4" y="2" rx="2" /><line x1="8" x2="16" y1="6" y2="6" /><line x1="16" x2="16" y1="14" y2="18" /><path d="M16 10h.01" /><path d="M12 10h.01" /><path d="M8 10h.01" /><path d="M12 14h.01" /><path d="M8 14h.01" /><path d="M12 18h.01" /><path d="M8 18h.01" /></svg>,
            Building2: ({ size = 24 }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z" /><path d="M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2" /><path d="M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2" /><path d="M10 6h4" /><path d="M10 10h4" /><path d="M10 14h4" /><path d="M10 18h4" /></svg>,
            FileText: ({ size = 24 }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z" /><polyline points="14 2 14 8 20 8" /><line x1="16" x2="8" y1="13" y2="13" /><line x1="16" x2="8" y1="17" y2="17" /><line x1="10" x2="8" y1="9" y2="9" /></svg>,
            Briefcase: ({ size = 20 }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="20" height="14" x="2" y="7" rx="2" ry="2" /><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16" /></svg>,
            MapPin: ({ size = 16 }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z" /><circle cx="12" cy="10" r="3" /></svg>,
            Wallet: ({ size = 24 }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 12V7H5a2 2 0 0 1 0-4h14v4" /><path d="M3 5v14a2 2 0 0 0 2 2h16v-5" /><path d="M18 12a2 2 0 0 0 0 4h4v-4Z" /></svg>,
            ArrowRightLeft: ({ size = 24 }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m16 3 4 4-4 4" /><path d="M20 7H4" /><path d="m8 21-4-4 4-4" /><path d="M4 17h16" /></svg>,
            HelpCircle: ({ size = 18 }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10" /><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3" /><path d="M12 17h.01" /></svg>,
            PieChart: ({ size = 18 }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21.21 15.89A10 10 0 1 1 8 2.83" /><path d="M22 12A10 10 0 0 0 12 2v10z" /></svg>
        };

        // --- DADOS E LÓGICA TRIBUTÁRIA (Expandida para evitar erros) ---
        const INSS_RANGES = [
            { limit: 1509.00, rate: 0.075 },
            { limit: 2750.00, rate: 0.09 },
            { limit: 4100.00, rate: 0.12 },
            { limit: 8000.00, rate: 0.14 },
        ];

        const IRPF_RANGES = [
            { limit: 2259.20, rate: 0.00, deduction: 0 },
            { limit: 2826.65, rate: 0.075, deduction: 169.44 },
            { limit: 3751.05, rate: 0.15, deduction: 381.44 },
            { limit: 4664.68, rate: 0.225, deduction: 662.77 },
            { limit: Infinity, rate: 0.275, deduction: 896.00 },
        ];

        const SIMPLES_ANEXO_III = [
            { limit: 180000, rate: 0.06, deduction: 0 },
            { limit: 360000, rate: 0.112, deduction: 9360 },
            { limit: 720000, rate: 0.135, deduction: 17640 },
            { limit: 1800000, rate: 0.16, deduction: 35640 },
            { limit: 3600000, rate: 0.21, deduction: 125640 },
            { limit: 4800000, rate: 0.33, deduction: 648000 },
        ];

        function calculateINSS(gross) {
            let tax = 0;
            let previousLimit = 0;
            for (const range of INSS_RANGES) {
                if (gross > previousLimit) {
                    const taxableAmount = Math.min(gross, range.limit) - previousLimit;
                    tax += taxableAmount * range.rate;
                    previousLimit = range.limit;
                } else {
                    break;
                }
            }
            return tax;
        }

        function calculateIRPF(gross, inss, dependents) {
            const deductionPerDependent = 189.59;
            const simplifiedDiscount = 564.80;

            const baseSalaryNormal = gross - inss - (dependents * deductionPerDependent);
            const baseSalarySimplified = gross - simplifiedDiscount;
            const realBase = Math.min(baseSalaryNormal, baseSalarySimplified);

            let tax = 0;
            for (const range of IRPF_RANGES) {
                if (realBase <= range.limit) {
                    tax = (realBase * range.rate) - range.deduction;
                    break;
                } else if (range.limit === Infinity) {
                    tax = (realBase * range.rate) - range.deduction;
                }
            }
            return Math.max(0, tax);
        }

        function calculateDAS(monthlyGross) {
            const annualRevenue = monthlyGross * 12;
            let rangeInfo = SIMPLES_ANEXO_III[0];
            for (const range of SIMPLES_ANEXO_III) {
                if (annualRevenue <= range.limit) {
                    rangeInfo = range;
                    break;
                }
                rangeInfo = range;
            }
            const effectiveRate = ((annualRevenue * rangeInfo.rate) - rangeInfo.deduction) / annualRevenue;
            return monthlyGross * effectiveRate;
        }

        function calculateAllCLT(input) {
            const salary = Number(input.salary) || 0;
            const dependents = Number(input.dependents) || 0;
            const mealVoucher = Number(input.mealVoucherValue) || 0;
            const health = Number(input.healthInsurance) || 0;

            // Descontos Colaborador
            const inss = calculateINSS(salary);
            const irpf = calculateIRPF(salary, inss, dependents);
            const vtCost = input.transportVoucher ? Math.min(salary * 0.06, 22 * 5 * 4.4) : 0; // Estimativa
            const totalDesc = inss + irpf + vtCost;

            // Custos Empresa
            const fgts = salary * 0.08;
            const vacation = (salary / 12) * 1.33; // Férias + 1/3
            const thirteenth = salary / 12;
            const patronalRate = input.isSimplesNacionalEmployer ? 0 : 0.288; // 20% + RAT/FAP
            const inssPatronal = salary * patronalRate;

            return {
                grossSalary: salary,
                netSalary: salary - totalDesc,
                totalEmployerCost: salary + fgts + vacation + thirteenth + inssPatronal + (mealVoucher * 22) + health,
                employerBreakdown: {
                    inssPatronal,
                    fgts,
                    provisions: vacation + thirteenth,
                    benefits: (mealVoucher * 22) + health
                }
            };
        }

        function calculatePJ(input) {
            const gross = Number(input.grossIncome) || 0;
            // Fator R: Pro-labore de 28%
            const proLabore = gross * 0.28;

            const das = calculateDAS(gross);
            const inss = Math.min(proLabore, 7786.02) * 0.11; // Teto 2024
            const irpf = calculateIRPF(proLabore, inss, 0);

            const totalTaxes = das + inss + irpf;

            return {
                grossInvoice: gross,
                netIncome: gross - totalTaxes,
                taxes: { das, inss, irpf, total: totalTaxes },
                breakdown: { proLabore }
            };
        }

        // --- COMPONENTES UI (Gráfico CSS Puro) ---

        const DonutChart = ({ data }) => {
            if (!data || data.length === 0) return null;

            const total = data.reduce((acc, item) => acc + item.value, 0);
            let currentAngle = 0;

            const gradientParts = data.map(item => {
                const percentage = (item.value / total) * 100;
                const start = currentAngle;
                const end = currentAngle + percentage;
                currentAngle = end;
                return `${item.color} ${start}% ${end}%`;
            });

            const gradient = `conic-gradient(${gradientParts.join(', ')})`;

            const formatMoney = (v) => v.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });

            return (
                <div className="flex flex-col md:flex-row items-center gap-8 justify-center">
                    <div className="relative w-48 h-48 rounded-full shadow-2xl" style={{ background: gradient }}>
                        <div className="absolute inset-0 m-auto w-32 h-32 bg-slate-800 rounded-full flex items-center justify-center flex-col">
                            <span className="text-xs text-slate-400">Total</span>
                            <span className="font-bold text-white text-sm">{formatMoney(total)}</span>
                        </div>
                    </div>

                    <div className="w-full space-y-2">
                        {data.map((item, idx) => (
                            <div key={idx} className="flex justify-between items-center text-sm border-b border-slate-700 pb-1">
                                <div className="flex items-center gap-2">
                                    <div className="w-3 h-3 rounded-full shadow" style={{ backgroundColor: item.color }}></div>
                                    <span className="text-slate-300">{item.name}</span>
                                </div>
                                <span className="text-white font-mono">{formatMoney(item.value)}</span>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        const Card = ({ children, className = "" }) => (
            <div className={`bg-slate-800 border border-slate-700 rounded-xl p-6 shadow-lg ${className}`}>
                {children}
            </div>
        );

        // --- APP PRINCIPAL ---

        const App = () => {
            const [activeTab, setActiveTab] = useState('clt');

            // Estados CLT
            const [cltInput, setCltInput] = useState({ salary: '', dependents: '', transportVoucher: false, mealVoucherValue: '', healthInsurance: '', isSimplesNacionalEmployer: false });
            const [cltResult, setCltResult] = useState(null);

            // Estados PJ
            const [pjInput, setPjInput] = useState({ grossIncome: '' });
            const [pjResult, setPjResult] = useState(null);

            // Efeitos
            useEffect(() => {
                if (cltInput.salary) setCltResult(calculateAllCLT(cltInput));
                else setCltResult(null);
            }, [cltInput]);

            useEffect(() => {
                if (pjInput.grossIncome) setPjResult(calculatePJ(pjInput));
                else setPjResult(null);
            }, [pjInput]);

            // Handlers
            const handleCltChange = (e) => {
                const { name, value, type, checked } = e.target;
                setCltInput(prev => ({ ...prev, [name]: type === 'checkbox' ? checked : value }));
            };

            const formatMoney = (v) => v.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });

            // Classes CSS Comuns
            const inputClass = "w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-all";
            const labelClass = "block text-sm font-medium text-slate-300 mb-1";

            // Dados para gráficos
            const cltData = cltResult ? [
                { name: 'Salário Líquido', value: cltResult.netSalary, color: '#22c55e' }, // Verde
                { name: 'INSS Patronal', value: cltResult.employerBreakdown.inssPatronal, color: '#ef4444' }, // Vermelho
                { name: 'FGTS', value: cltResult.employerBreakdown.fgts, color: '#f97316' }, // Laranja
                { name: 'Provisões', value: cltResult.employerBreakdown.provisions, color: '#eab308' }, // Amarelo
                { name: 'Benefícios', value: cltResult.employerBreakdown.benefits, color: '#a855f7' } // Roxo
            ].filter(d => d.value > 0) : [];

            const pjData = pjResult ? [
                { name: 'Líquido', value: pjResult.netIncome, color: '#22c55e' },
                { name: 'Impostos', value: pjResult.taxes.total, color: '#ef4444' }
            ] : [];

            return (
                <div className="min-h-screen pb-20 fade-in">
                    {/* Header */}
                    <header className="bg-slate-900 border-b border-slate-800 sticky top-0 z-20 shadow-lg">
                        <div className="max-w-7xl mx-auto px-4 h-16 flex items-center gap-3">
                            <div className="text-orange-500 p-2 bg-orange-500/10 rounded-lg">
                                <Icons.Calculator size={24} />
                            </div>
                            <h1 className="text-xl font-bold text-white tracking-tight">
                                Calculadora CLT x PJ <span className="text-orange-500">2026</span>
                            </h1>
                        </div>
                    </header>
                    <main className="max-w-7xl mx-auto px-4 py-8">
                        {/* Tabs */}
                        <div className="flex justify-center mb-8">
                            <div className="bg-slate-800 p-1 rounded-xl border border-slate-700 inline-flex">
                                <button
                                    onClick={() => setActiveTab('clt')}
                                    className={`px-6 py-2 rounded-lg text-sm font-medium flex items-center gap-2 transition-all ${activeTab === 'clt' ? 'bg-orange-500 text-white shadow-lg shadow-orange-500/20' : 'text-slate-400 hover:text-white'}`}
                                >
                                    <Icons.Building2 size={18} /> Custo Contratação (CLT)
                                </button>
                                <button
                                    onClick={() => setActiveTab('pj')}
                                    className={`px-6 py-2 rounded-lg text-sm font-medium flex items-center gap-2 transition-all ${activeTab === 'pj' ? 'bg-orange-500 text-white shadow-lg shadow-orange-500/20' : 'text-slate-400 hover:text-white'}`}
                                >
                                    <Icons.FileText size={18} /> Oferta PJ (B2B)
                                </button>
                            </div>
                        </div>

                        <div className="grid grid-cols-1 lg:grid-cols-12 gap-8">

                            {/* FORMULÁRIO */}
                            <div className="lg:col-span-5 space-y-6">
                                <Card>
                                    <h2 className="text-lg font-semibold text-white mb-6 flex items-center gap-2">
                                        <span className="text-orange-500"><Icons.Briefcase size={20} /></span>
                                        {activeTab === 'clt' ? 'Dados da Vaga' : 'Dados da Proposta'}
                                    </h2>

                                    {activeTab === 'clt' ? (
                                        <div className="space-y-4">
                                            <div>
                                                <label className={labelClass}>Salário Bruto</label>
                                                <div className="relative">
                                                    <span className="absolute left-4 top-3.5 text-slate-400">R$</span>
                                                    <input type="number" name="salary" value={cltInput.salary} onChange={handleCltChange} className={`${inputClass} pl-10`} placeholder="0.00" />
                                                </div>
                                            </div>
                                            <div className="grid grid-cols-2 gap-4">
                                                <div>
                                                    <label className={labelClass}>Dependentes</label>
                                                    <input type="number" name="dependents" value={cltInput.dependents} onChange={handleCltChange} className={inputClass} placeholder="0" />
                                                </div>
                                                <div>
                                                    <label className={labelClass}>VR (Dia)</label>
                                                    <input type="number" name="mealVoucherValue" value={cltInput.mealVoucherValue} onChange={handleCltChange} className={inputClass} placeholder="0.00" />
                                                </div>
                                            </div>
                                            <div>
                                                <label className={labelClass}>Plano de Saúde (Total)</label>
                                                <div className="relative">
                                                    <span className="absolute left-4 top-3.5 text-slate-400">R$</span>
                                                    <input type="number" name="healthInsurance" value={cltInput.healthInsurance} onChange={handleCltChange} className={`${inputClass} pl-10`} placeholder="0.00" />
                                                </div>
                                            </div>
                                            <div className="space-y-3 pt-4 border-t border-slate-700">
                                                <label className="flex items-center gap-3 cursor-pointer group">
                                                    <input type="checkbox" name="transportVoucher" checked={cltInput.transportVoucher} onChange={handleCltChange} className="w-5 h-5 accent-orange-500 rounded bg-slate-700 border-slate-600" />
                                                    <span className="text-slate-300 group-hover:text-white transition-colors">Vale Transporte?</span>
                                                </label>
                                                <label className="flex items-center gap-3 cursor-pointer group">
                                                    <input type="checkbox" name="isSimplesNacionalEmployer" checked={cltInput.isSimplesNacionalEmployer} onChange={handleCltChange} className="w-5 h-5 accent-orange-500 rounded bg-slate-700 border-slate-600" />
                                                    <div>
                                                        <span className="block text-slate-300 group-hover:text-white transition-colors">Empresa Simples Nacional?</span>
                                                        <span className="text-xs text-slate-500">Isenção de INSS Patronal</span>
                                                    </div>
                                                </label>
                                            </div>
                                        </div>
                                    ) : (
                                        <div className="space-y-4">
                                            <div>
                                                <label className={labelClass}>Valor da Nota Fiscal</label>
                                                <div className="relative">
                                                    <span className="absolute left-4 top-3.5 text-slate-400">R$</span>
                                                    <input type="number" name="grossIncome" value={pjInput.grossIncome} onChange={(e) => setPjInput({ grossIncome: e.target.value })} className={`${inputClass} pl-10`} placeholder="0.00" />
                                                </div>
                                                <p className="text-xs text-slate-500 mt-2">
                                                    Cálculo baseado no Anexo III com Fator R (Pró-labore automático de 28%).
                                                </p>
                                            </div>
                                        </div>
                                    )}
                                </Card>
                            </div>

                            {/* RESULTADOS */}
                            <div className="lg:col-span-7 space-y-6">
                                {((activeTab === 'clt' && !cltResult) || (activeTab === 'pj' && !pjResult)) ? (
                                    <div className="h-full min-h-[400px] flex flex-col items-center justify-center bg-slate-800/50 border border-slate-700 border-dashed rounded-xl p-8 text-center">
                                        <div className="w-16 h-16 bg-slate-800 rounded-full flex items-center justify-center mb-4 text-orange-500">
                                            <Icons.Calculator size={32} />
                                        </div>
                                        <h3 className="text-xl font-bold text-white mb-2">Aguardando dados...</h3>
                                        <p className="text-slate-400">Preencha os valores ao lado para visualizar a simulação completa.</p>
                                    </div>
                                ) : (
                                    <>
                                        {/* CARDS DE DESTAQUE */}
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <Card className="bg-gradient-to-br from-slate-800 to-slate-800/50 border-orange-500/20 border">
                                                <div className="flex items-center gap-3 mb-2 text-emerald-400">
                                                    <Icons.Wallet size={24} />
                                                    <span className="font-semibold">Líquido na Mão</span>
                                                </div>
                                                <div className="text-3xl font-bold text-white">
                                                    {formatMoney(activeTab === 'clt' ? cltResult.netSalary : pjResult.netIncome)}
                                                </div>
                                                <div className="text-xs text-slate-400 mt-1">Valor mensal livre de impostos</div>
                                            </Card>

                                            <Card>
                                                <div className="flex items-center gap-3 mb-2 text-red-400">
                                                    <Icons.ArrowRightLeft size={24} />
                                                    <span className="font-semibold">{activeTab === 'clt' ? 'Custo Total Empresa' : 'Total Impostos'}</span>
                                                </div>
                                                <div className="text-3xl font-bold text-white">
                                                    {formatMoney(activeTab === 'clt' ? cltResult.totalEmployerCost : pjResult.taxes.total)}
                                                </div>
                                                <div className="text-xs text-slate-400 mt-1">
                                                    {activeTab === 'clt' ? 'Salário + Encargos + Benefícios' : 'DAS + INSS + IRPF'}
                                                </div>
                                            </Card>
                                        </div>

                                        {/* GRÁFICO E DETALHES */}
                                        <div className="grid grid-cols-1 gap-6">
                                            <Card>
                                                <h3 className="font-semibold text-white mb-6 flex items-center gap-2">
                                                    <Icons.PieChart size={20} className="text-orange-500" />
                                                    Composição Financeira
                                                </h3>
                                                <DonutChart data={activeTab === 'clt' ? cltData : pjData} />
                                            </Card>
                                        </div>
                                    </>
                                )}
                            </div>
                        </div>
                    </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
